{"version":3,"file":"launch.min.js","sources":["../src/launch.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Launch the interactive video in modal on course page\n *\n * @module     mod_interactivevideo/launch\n * @copyright  2024 Sokunthearith Makara <sokunthearithmakara@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/str', 'core/templates'], function($, str, Templates) {\n    return {\n        init: async function() {\n            // Launch the interactive video in modal\n            $(document).on('click', '.launch-interactivevideo', async function(e) {\n                // Save the current document title.\n                let title = document.title;\n                // Get showcontrols from cache.\n                let showcontrols = localStorage.getItem('showcontrols') ? true : false;\n                e.preventDefault();\n                const id = $(this).data('id');\n                const instance = $(this).data('instance');\n                const course = $(this).data('course');\n                const contextid = $(this).data('contextid');\n                const $card = $(this).closest('#interactivevideo-' + instance);\n                $card.find('.image-container').addClass('hovered');\n                let dataForTemplate = {\n                    id: id,\n                    showcontrols: showcontrols,\n                    root: M.cfg.wwwroot,\n                };\n\n                const modal = await Templates.render('mod_interactivevideo/playermodal', dataForTemplate);\n\n                $('#playermodal').remove(); // Important:: Remove the previous modal ONLY after the new one is created.\n                $('body').append(modal);\n                $('#playermodal').modal('show');\n\n                const headerFunction = function() {\n                    let $header = $('#playermodal .modal-header');\n                    if ($header.hasClass('show')) {\n                        return;\n                    }\n\n                    $header.addClass('show');\n                    $header.fadeIn();\n                    if (!$('#playermodal').hasClass('locked')) {\n                        setTimeout(function() {\n                            $header.removeClass('show');\n                            $header.fadeOut();\n                        }, 5000);\n                    }\n                };\n\n                let iframeDoc, iframeAnnos, details, player;\n                $('#playermodal').on('shown.bs.modal', function() {\n                    $('body').addClass('overflow-hidden');\n                    $(this).find('.modal-header').addClass('show');\n                    if (localStorage.getItem('lock-bar')) {\n                        $(this).find('.lock-bar').trigger('click');\n                    }\n                    // Copy the activity information to the modal header.\n                    let $completion = $card.find('[data-region=activity-information]');\n                    $completion = $completion.clone();\n                    $(this).find('[data-region=\"activity-completion\"]').html($completion);\n                    // Listen the player timeupdate event in the iframe.\n                    let checkIframeDoc = function() {\n                        try {\n                            iframeDoc = document.getElementById('ivplayer').contentDocument;\n                        } catch (e) {\n                            cancelAnimationFrame(checkIframeDoc);\n                            return;\n                        }\n                        iframeAnnos = document.getElementById('ivplayer').contentWindow.IVANNO;\n                        if (!iframeDoc.getElementById('player')) {\n                            requestAnimationFrame(checkIframeDoc);\n                            return;\n                        }\n                        // Hide the background-loading.\n                        $('#background-loading').hide(0);\n                        if (!iframeAnnos) {\n                            requestAnimationFrame(checkIframeDoc);\n                            return;\n                        }\n\n                        player = document.getElementById('ivplayer').contentWindow.IVPLAYER;\n\n                        if (iframeDoc.getElementById('player')) {\n                            $('#playermodal .modal-header').removeClass('show');\n                            $('#playermodal .toggle-controls').removeClass('d-none');\n\n                            if (!showcontrols) {\n                                setTimeout(function() {\n                                    $('#playermodal .modal-content').removeClass('show-control');\n                                }, 1000);\n                            }\n\n                            $('#playermodal .toggle-controls').on('click', function() {\n                                $('#playermodal .modal-content').toggleClass('show-control');\n                                showcontrols = $('#playermodal .modal-content').hasClass('show-control');\n                                if (showcontrols) {\n                                    localStorage.setItem('showcontrols', '1');\n                                } else {\n                                    localStorage.removeItem('showcontrols');\n                                }\n                            });\n\n                            iframeDoc.addEventListener('annotationitemsrendered', function(e) {\n                                details = e.detail;\n                            });\n\n                            $(iframeDoc).on('mousemove', '#video-wrapper', function() {\n                                if ($('#playermodal').hasClass('locked')) {\n                                    return;\n                                }\n                                let $message = iframeDoc.querySelector('#message:not(.sticky)');\n                                let $activestart = iframeDoc.querySelector('#start-screen:not(.d-none) .hasintro');\n                                if ($message || $activestart) {\n                                    $('#playermodal .modal-header').removeClass('show');\n                                } else {\n                                    headerFunction();\n                                }\n                            });\n\n                            iframeDoc.addEventListener('videoPaused', function() {\n                                if ($('#playermodal').hasClass('locked')) {\n                                    return;\n                                }\n                                let $message = iframeDoc.querySelector('#message:not(.sticky)');\n                                let $activestart = iframeDoc.querySelector('#start-screen:not(.d-none) .hasintro');\n                                if ($message || $activestart) {\n                                    $('#playermodal .modal-header').removeClass('show');\n                                } else {\n                                    headerFunction();\n                                }\n                                $('#playermodal .toggle-controls').fadeOut(300);\n                            });\n\n                            iframeDoc.addEventListener('iv:playerPlaying', function() {\n                                $('#playermodal .toggle-controls').fadeIn(300);\n                            });\n\n                            // Analytics progress bar.\n                            let $progressbar = $card.find('.analytics.progress .progress-bar');\n                            if ($progressbar.length == 0) {\n                                return;\n                            }\n                            let current = $progressbar.data('current');\n                            iframeDoc.addEventListener('analyticsupdated', function(e) {\n                                let percentage = e.detail.percentage;\n                                if (percentage > current) {\n                                    $progressbar.css('width', percentage + '%')\n                                        .data('current', percentage);\n                                    $card.find('.analytics-percentage').text(Math.round(percentage));\n                                }\n                            });\n                        } else {\n                            requestAnimationFrame(checkIframeDoc);\n                        }\n                    };\n                    requestAnimationFrame(checkIframeDoc);\n\n                    $(this).off('hidden.bs.modal').on('hidden.bs.modal', function() {\n                        cancelAnimationFrame(checkIframeDoc);\n                    });\n\n                    $(document).off('click', '#playermodal [data-action=\"toggle-manual-completion\"]')\n                        .on('click', '#playermodal [data-action=\"toggle-manual-completion\"]', function() {\n                            $(this).parent().addClass('updated');\n                            if ($(this).data('withavailability') == 1) {\n                                history.pushState(null, null, M.cfg.wwwroot + '/course/view.php?id=' + course + '#module-' + id);\n                            }\n                        });\n\n                    // Update the browser url to the current activity.\n                    history.pushState(null, null, M.cfg.wwwroot + '/mod/interactivevideo/view.php?id=' + id);\n                    // Update the title of tab to the activity name.\n                    let activitytitle = $card.data('title');\n                    document.title = activitytitle;\n                });\n\n                $('#playermodal').on('hide.bs.modal', async function() {\n                    $('body').removeClass('overflow-hidden');\n                    // Trigger hover on .image-container for 2 seconds.\n                    setTimeout(function() {\n                        $card.find('.image-container').removeClass('hovered');\n                    }, 1000);\n\n                    if (player) { // Must check this in case user close modal before the player is ready.\n                        await player.pause();\n                    } else {\n                        $(this).remove();\n                        return;\n                    }\n                    // If there is automatic completion conditions, we have to update it.\n                    let $autocompletion = $card.find('.automatic-completion-conditions');\n                    if ($autocompletion.length > 0) {\n                        const completion = await $.ajax({\n                            url: M.cfg.wwwroot + '/mod/interactivevideo/ajax.php',\n                            method: 'POST',\n                            dataType: 'text',\n                            data: {\n                                action: 'get_cm_completion',\n                                cmid: id,\n                                sesskey: M.cfg.sesskey,\n                                contextid: contextid,\n                                courseid: course,\n                                userid: M.cfg.userId || 0,\n                            }\n                        });\n\n                        if (completion) {\n                            const completiondata = JSON.parse(completion);\n                            $card.find('[data-region=activity-information]')\n                                .html($(completiondata.completion).html());\n                        }\n                    }\n\n                    // If there is manual completion, we have to copy the button to the course page.\n                    let $manualcompletion = $(this).find('.completion-info.updated');\n                    if ($manualcompletion.length > 0) {\n                        $card.find('.completion-info').html($manualcompletion.html());\n                    }\n\n                    if (details) {\n                        let progressbar = $card.find('.tasks .progress-bar');\n                        if (progressbar.length > 0) {\n                            progressbar.css('width', Math.round(details.completed / details.total * 100) + '%');\n                            if (details.completed == details.total) {\n                                progressbar.addClass('bg-success').removeClass('bg-primary');\n                            } else {\n                                progressbar.removeClass('bg-success').addClass('bg-primary');\n                            }\n                            $card.find('.percentage')\n                                .text(Math.round(details.completed / details.total * 100));\n                            $card.find('.items').text(`(${details.completed}/${details.total})`);\n                            $card.find('.xp').text(details.xp);\n                        }\n                    }\n\n                    // Update the browser url to the current course.\n                    history.pushState(null, null, M.cfg.wwwroot + '/course/view.php?id=' + course);\n                    document.title = title;\n\n                    if (iframeAnnos) {\n                        // Remove the new-bagde from the poster.\n                        $card.find('.new-badge').remove();\n                    }\n\n                    $card.closest('.modtype_interactivevideo')[0]\n                        .scrollIntoView({behavior: \"smooth\", block: \"center\", inline: \"center\"});\n\n                    if (iframeDoc) {\n                        $(iframeDoc).off();\n                    }\n                });\n\n                // Close modal when the browser back button is clicked.\n                window.onpopstate = function(e) {\n                    if (e.target.location.pathname == '/course/view.php') {\n                        $('#playermodal').modal('hide');\n                    }\n                };\n\n                $(document).off('click', '.lock-bar').on('click', '.lock-bar', async function(e) {\n                    e.preventDefault();\n                    $(this).toggleClass('locked');\n                    $('#playermodal').toggleClass('locked');\n                    if ($(this).hasClass('locked')) {\n                        $(this).attr('title', await str.get_string('unlock', 'mod_interactivevideo'));\n                        $(this).find('i').removeClass('fa-unlock').addClass('fa-lock');\n                        $('#playermodal .modal-header').addClass('show');\n                        // Save to local storage.\n                        localStorage.setItem('lock-bar', '1');\n                        headerFunction();\n                    } else {\n                        $(this).attr('title', await str.get_string('lock', 'mod_interactivevideo'));\n                        $(this).find('i').removeClass('fa-lock').addClass('fa-unlock');\n                        // Remove from local storage.\n                        localStorage.removeItem('lock-bar');\n                        setTimeout(function() {\n                            $('#playermodal .modal-header').removeClass('show');\n                        }, 5000);\n                    }\n\n                });\n            });\n\n            $(document).on('click', '.open-external-link', function() {\n                $('#playermodal').modal('hide');\n                window.open($(this).data('href'), '_blank');\n            });\n\n            $(document).on('click', '.interactivevideo-card .description-show', function() {\n                const $description = $(this).closest('.top-section').find('.description');\n                $description.slideToggle('fast', 'swing');\n                $(this).toggleClass('rotate');\n            });\n\n            // Get the #hash from the url and scroll to the element and hover it.\n            $(document).ready(function() {\n                let hash = window.location.hash;\n                if (hash) {\n                    let $element = $(hash);\n                    if ($element.length > 0 && $element.hasClass('modtype_interactivevideo')) {\n                        $element.addClass('highlighted');\n                        setTimeout(() => {\n                            $element[0].scrollIntoView({behavior: \"smooth\", block: \"center\", inline: \"center\"});\n                            setTimeout(function() {\n                                $element.removeClass('highlighted');\n                            }, 3000);\n                        }, 1000);\n                    }\n                }\n            });\n\n            // Launch report modal.\n            $(document).on('click', '.launch-report', async function(e) {\n                e.preventDefault();\n                const href = $(this).data('href');\n\n                // If control or command key is pressed, open the modal. Otherwise, follow the link.\n                if (!e.ctrlKey && !e.metaKey) {\n                    window.location.href = href;\n                    return;\n                }\n\n                const data = {\n                    id: 'reportModal',\n                    title: await str.get_string('reportfor', 'mod_interactivevideo', $(this).data('title')),\n                    body: `<iframe src=\"${href}&embed=1\"\n                                        style=\"width: 100%; height: 100%; border: 0; z-index:1050; position:absolute;\"></iframe>`,\n                };\n                let Modal = await Templates.render('mod_interactivevideo/fullscreenmodal', data);\n\n                $('body').append(Modal);\n                $('#reportModal').modal('show');\n                $('#reportModal').on('shown.bs.modal', function() {\n                    $(this).focus();\n                });\n                $('#reportModal').on('hidden.bs.modal', function() {\n                    $(this).remove();\n                });\n            });\n\n            // Quick form for interactive video settings.\n            let ModalForm, addToast;\n            $(document).on('click', '.iv_quickform', async function(e) {\n                const $this = $(this);\n                e.preventDefault();\n                const href = $this.data('href');\n                if (!e.ctrlKey && !e.metaKey) {\n                    window.location.href = href;\n                    return;\n                }\n\n                let formdata = {\n                    contextid: $(this).data('contextid'),\n                    cmid: $(this).data('cmid'),\n                    courseid: $(this).data('courseid'),\n                    interaction: $(this).data('interaction'),\n                    origin: 'coursepage',\n                };\n\n                if (!ModalForm) {\n                    ModalForm = await import('core_form/modalform');\n                }\n\n                if (!addToast) {\n                    addToast = await import('core/toast');\n                }\n\n                let form = new ModalForm({\n                    formClass: 'mod_interactivevideo\\\\form\\\\quicksettings_form',\n                    args: formdata,\n                    modalConfig: {\n                        title: await str.get_string('quicksettings', 'mod_interactivevideo'),\n                        removeOnClose: true,\n                    }\n                });\n\n                form.show();\n\n                form.addEventListener(form.events.LOADED, (e) => {\n                    e.stopImmediatePropagation();\n                    // Replace the .modal-lg class with .modal-xl.\n                    setTimeout(() => {\n                        $('.modal-dialog').removeClass('modal-lg').addClass('modal-xl path-mod-interactivevideo');\n                    }, 1000);\n                    setTimeout(async() => {\n                        let strings = await str.get_strings([\n                            {key: 'moresettings', component: 'mod_interactivevideo'},\n                            {key: 'resettodefaults', component: 'mod_interactivevideo'},\n                        ]);\n                        $('[data-region=\"footer\"]').css('align-items', 'unset')\n                            .prepend(`<span class=\"btn btn-secondary mr-1 default\" title=\"${strings[1]}\">\n                        <i class=\"fa fa-refresh\"></i></span>\n                        <a type=\"button\" class=\"btn btn-secondary mr-auto\" target=\"_blank\" data-dismiss=\"modal\"\n                            title=\"${strings[0]}\"\n                            href=\"${M.cfg.wwwroot}/course/modedit.php?update=${formdata.cmid}\"><i class=\"fa fa-cog\"></i>\n                            </a>`);\n                    }, 2000);\n                });\n\n                form.addEventListener(form.events.FORM_SUBMITTED, (e) => {\n                    e.stopImmediatePropagation();\n                    addToast.add(str.get_string('settingssaved', 'mod_interactivevideo'), {\n                        type: 'success',\n                    });\n                    // Replace the activity card with the new one.\n                    let $newcard = $(e.detail.html);\n                    $this.closest('.modtype_interactivevideo').replaceWith($newcard).trigger('click');\n                });\n\n                let DynamicForm;\n                $(document).off('click', '.default').on('click', '.default', async function(e) {\n                    e.preventDefault();\n                    formdata.action = 'reset';\n                    if (!DynamicForm) {\n                        DynamicForm = await import('core_form/dynamicform');\n                    }\n                    let form = new DynamicForm(document.querySelector('[data-region=\"body\"]'),\n                        'mod_interactivevideo\\\\form\\\\quicksettings_form');\n                    form.load(formdata);\n                    addToast.add(str.get_string('formvaluesarereset', 'mod_interactivevideo'), {\n                        type: 'info',\n                    });\n                });\n            });\n        },\n    };\n});"],"names":["define","$","str","Templates","init","async","ModalForm","addToast","document","on","e","title","showcontrols","localStorage","getItem","preventDefault","id","this","data","instance","course","contextid","$card","closest","find","addClass","dataForTemplate","root","M","cfg","wwwroot","modal","render","remove","append","headerFunction","$header","hasClass","fadeIn","setTimeout","removeClass","fadeOut","iframeDoc","iframeAnnos","details","player","trigger","$completion","clone","html","checkIframeDoc","getElementById","contentDocument","cancelAnimationFrame","contentWindow","IVANNO","hide","IVPLAYER","toggleClass","setItem","removeItem","addEventListener","detail","$message","querySelector","$activestart","$progressbar","length","current","percentage","css","text","Math","round","requestAnimationFrame","off","parent","history","pushState","activitytitle","pause","completion","ajax","url","method","dataType","action","cmid","sesskey","courseid","userid","userId","completiondata","JSON","parse","$manualcompletion","progressbar","completed","total","xp","scrollIntoView","behavior","block","inline","window","onpopstate","target","location","pathname","attr","get_string","open","slideToggle","ready","hash","$element","href","ctrlKey","metaKey","body","Modal","focus","$this","formdata","interaction","origin","DynamicForm","form","formClass","args","modalConfig","removeOnClose","show","events","LOADED","stopImmediatePropagation","strings","get_strings","key","component","prepend","FORM_SUBMITTED","add","type","$newcard","replaceWith","load"],"mappings":"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"}