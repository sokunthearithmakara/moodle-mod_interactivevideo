{"version":3,"file":"quickform.min.js","sources":["../src/quickform.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * TODO describe module quickform\n *\n * @module     mod_interactivevideo/quickform\n * @copyright  2025 Sokunthearith Makara <sokunthearithmakara@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\nimport {dispatchEvent} from 'core/event_dispatcher';\n\nconst quickform = async() => {\n    let ModalForm, str;\n    $(document).on('click', '.iv_quickform', async function(e) {\n        let data = {\n            contextid: $(this).data('contextid'),\n            cmid: $(this).data('cmid'),\n            courseid: $(this).data('courseid'),\n            interaction: $(this).data('interaction'),\n            origin: $(this).data('origin'),\n        };\n        e.preventDefault();\n        // Hold control/cmd to go to data-href.\n        if (!e.ctrlKey && !e.metaKey) {\n            window.location.href = $(this).data('href');\n            return;\n        }\n\n        if (!ModalForm) {\n            ModalForm = await import('core_form/modalform');\n        }\n\n        if (!str) {\n            str = await import('core/str');\n        }\n\n        let form = new ModalForm({\n            formClass: 'mod_interactivevideo\\\\form\\\\quicksettings_form',\n            args: data,\n            modalConfig: {\n                title: await str.get_string('quicksettings', 'mod_interactivevideo'),\n                removeOnClose: true,\n            }\n        });\n\n        form.show();\n\n        form.addEventListener(form.events.LOADED, (e) => {\n            e.stopImmediatePropagation();\n            if (window.IVPLAYER) {\n                window.IVPLAYER.pause();\n            }\n            // Replace the .modal-lg class with .modal-xl.\n            setTimeout(() => {\n                $('.modal-dialog').removeClass('modal-lg').addClass('modal-xl');\n            }, 1000);\n            setTimeout(async() => {\n                let strings = await str.get_strings([\n                    {key: 'moresettings', component: 'mod_interactivevideo'},\n                    {key: 'resettodefaults', component: 'mod_interactivevideo'},\n                ]);\n                $('[data-region=\"footer\"]').css('align-items', 'unset')\n                    .prepend(`<span class=\"btn btn-secondary mr-1 default\" title=\"${strings[1]}\"><i class=\"fa fa-refresh\"></i>\n                        </span>\n                        <a type=\"button\" class=\"btn btn-secondary mr-auto\" data-dismiss=\"modal\" title=\"${strings[0]}\"\n                 href=\"${M.cfg.wwwroot}/course/modedit.php?update=${data.cmid}\"><i class=\"fa fa-cog\"></i>\n                 </a>`);\n            }, 2000);\n        });\n\n        form.addEventListener(form.events.FORM_SUBMITTED, (e) => {\n            e.stopImmediatePropagation();\n            data.detail = e.detail;\n            if (data.origin === 'navbar') {\n                $('#background-loading').show();\n                window.location.reload();\n            } else {\n                dispatchEvent('quickformsubmitted', data);\n            }\n        });\n\n        let DynamicForm;\n        $(document).off('click', '.default').on('click', '.default', async function(e) {\n            e.preventDefault();\n            data.action = 'reset';\n            if (!DynamicForm) {\n                DynamicForm = await import('core_form/dynamicform');\n            }\n            let form = new DynamicForm(document.querySelector('[data-region=\"body\"]'),\n                'mod_interactivevideo\\\\form\\\\quicksettings_form');\n            form.load(data);\n        });\n    });\n};\n\nexport default quickform;"],"names":["async","ModalForm","str","document","on","e","data","contextid","this","cmid","courseid","interaction","origin","preventDefault","ctrlKey","metaKey","window","location","href","DynamicForm","form","formClass","args","modalConfig","title","get_string","removeOnClose","show","addEventListener","events","LOADED","stopImmediatePropagation","IVPLAYER","pause","setTimeout","removeClass","addClass","strings","get_strings","key","component","css","prepend","M","cfg","wwwroot","FORM_SUBMITTED","detail","reload","off","action","querySelector","load"],"mappings":"kbA0BkBA,cACVC,UAAWC,wBACbC,UAAUC,GAAG,QAAS,iBAAiBJ,eAAeK,OAChDC,KAAO,CACPC,WAAW,mBAAEC,MAAMF,KAAK,aACxBG,MAAM,mBAAED,MAAMF,KAAK,QACnBI,UAAU,mBAAEF,MAAMF,KAAK,YACvBK,aAAa,mBAAEH,MAAMF,KAAK,eAC1BM,QAAQ,mBAAEJ,MAAMF,KAAK,cAEzBD,EAAEQ,kBAEGR,EAAES,UAAYT,EAAEU,oBACjBC,OAAOC,SAASC,MAAO,mBAAEV,MAAMF,KAAK,SAInCL,YACDA,4nBAGCC,MACDA,ylBAgDAiB,YA7CAC,KAAO,IAAInB,UAAU,CACrBoB,UAAW,iDACXC,KAAMhB,KACNiB,YAAa,CACTC,YAAatB,IAAIuB,WAAW,gBAAiB,wBAC7CC,eAAe,KAIvBN,KAAKO,OAELP,KAAKQ,iBAAiBR,KAAKS,OAAOC,QAASzB,IACvCA,EAAE0B,2BACEf,OAAOgB,UACPhB,OAAOgB,SAASC,QAGpBC,YAAW,yBACL,iBAAiBC,YAAY,YAAYC,SAAS,cACrD,KACHF,YAAWlC,cACHqC,cAAgBnC,IAAIoC,YAAY,CAChC,CAACC,IAAK,eAAgBC,UAAW,wBACjC,CAACD,IAAK,kBAAmBC,UAAW,8CAEtC,0BAA0BC,IAAI,cAAe,SAC1CC,sEAA+DL,QAAQ,uLAEaA,QAAQ,wCACxFM,EAAEC,IAAIC,8CAAqCvC,KAAKG,8DAE1D,QAGPW,KAAKQ,iBAAiBR,KAAKS,OAAOiB,gBAAiBzC,IAC/CA,EAAE0B,2BACFzB,KAAKyC,OAAS1C,EAAE0C,OACI,WAAhBzC,KAAKM,4BACH,uBAAuBe,OACzBX,OAAOC,SAAS+B,8CAEF,qBAAsB1C,6BAK1CH,UAAU8C,IAAI,QAAS,YAAY7C,GAAG,QAAS,YAAYJ,eAAeK,GACxEA,EAAEQ,iBACFP,KAAK4C,OAAS,QACT/B,cACDA,ooBAEO,IAAIA,YAAYhB,SAASgD,cAAc,wBAC9C,kDACCC,KAAK9C"}