{"version":3,"file":"quickform.min.js","sources":["../src/quickform.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * TODO describe module quickform\n *\n * @module     mod_interactivevideo/quickform\n * @copyright  2025 Sokunthearith Makara <sokunthearithmakara@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\nimport {dispatchEvent} from 'core/event_dispatcher';\n\nconst quickform = async() => {\n    let ModalForm, str;\n    $(document).on('click', '.iv_quickform', async function(e) {\n        let data = {\n            contextid: $(this).data('contextid'),\n            cmid: $(this).data('cmid'),\n            courseid: $(this).data('courseid'),\n            interaction: $(this).data('interaction'),\n            origin: $(this).data('origin'),\n        };\n        e.preventDefault();\n        // Hold control/cmd to go to data-href.\n        if (!e.ctrlKey && !e.metaKey) {\n            window.location.href = $(this).data('href');\n            return;\n        }\n\n        if (!ModalForm) {\n            ModalForm = await import('core_form/modalform');\n        }\n\n        if (!str) {\n            str = await import('core/str');\n        }\n\n        let form = new ModalForm({\n            formClass: 'mod_interactivevideo\\\\form\\\\quicksettings_form',\n            args: data,\n            modalConfig: {\n                title: await str.get_string('quicksettings', 'mod_interactivevideo'),\n                removeOnClose: true,\n            }\n        });\n\n        form.show();\n\n        form.addEventListener(form.events.LOADED, async(e) => {\n            e.stopImmediatePropagation();\n            if (window.IVPLAYER) {\n                window.IVPLAYER.pause();\n            }\n            // Replace the .modal-lg class with .modal-xl.\n            let root = form.modal.getRoot();\n            root.find('.modal-dialog').removeClass('modal-lg').addClass('modal-xl');\n            root.addClass('path-mod-interactivevideo');\n            let strings = await str.get_strings([\n                {key: 'moresettings', component: 'mod_interactivevideo'},\n                {key: 'resettodefaults', component: 'mod_interactivevideo'},\n            ]);\n            root.find('[data-region=\"footer\"]').css('align-items', 'unset')\n                .prepend(`<span class=\"btn btn-secondary iv-mr-1 default\" title=\"${strings[1]}\"><i class=\"fa fa-refresh\"></i>\n                        </span>\n                        <a type=\"button\" class=\"btn btn-secondary iv-mr-auto\" data-dismiss=\"modal\" title=\"${strings[0]}\"\n                         data-bs-dismiss=\"modal\"\n                 href=\"${M.cfg.wwwroot}/course/modedit.php?update=${data.cmid}\"><i class=\"fa fa-cog\"></i>\n                 </a>`);\n        });\n\n        form.addEventListener(form.events.FORM_SUBMITTED, (e) => {\n            e.stopImmediatePropagation();\n            data.detail = e.detail;\n            if (data.origin === 'navbar') {\n                $('#background-loading').show();\n                window.location.reload();\n            } else {\n                dispatchEvent('quickformsubmitted', data);\n            }\n        });\n\n        let DynamicForm;\n        $(document).off('click', '.modal-footer .btn.default').on('click', '.modal-footer .btn.default', async function(e) {\n            e.preventDefault();\n            data.action = 'reset';\n            if (!DynamicForm) {\n                DynamicForm = await import('core_form/dynamicform');\n            }\n            let form = new DynamicForm(document.querySelector('[data-region=\"body\"]'),\n                'mod_interactivevideo\\\\form\\\\quicksettings_form');\n            form.load(data);\n        });\n    });\n};\n\nexport default quickform;"],"names":["async","ModalForm","str","document","on","e","data","contextid","this","cmid","courseid","interaction","origin","preventDefault","ctrlKey","metaKey","window","location","href","DynamicForm","form","formClass","args","modalConfig","title","get_string","removeOnClose","show","addEventListener","events","LOADED","stopImmediatePropagation","IVPLAYER","pause","root","modal","getRoot","find","removeClass","addClass","strings","get_strings","key","component","css","prepend","M","cfg","wwwroot","FORM_SUBMITTED","detail","reload","off","action","querySelector","load"],"mappings":"kbA0BkBA,cACVC,UAAWC,wBACbC,UAAUC,GAAG,QAAS,iBAAiBJ,eAAeK,OAChDC,KAAO,CACPC,WAAW,mBAAEC,MAAMF,KAAK,aACxBG,MAAM,mBAAED,MAAMF,KAAK,QACnBI,UAAU,mBAAEF,MAAMF,KAAK,YACvBK,aAAa,mBAAEH,MAAMF,KAAK,eAC1BM,QAAQ,mBAAEJ,MAAMF,KAAK,cAEzBD,EAAEQ,kBAEGR,EAAES,UAAYT,EAAEU,oBACjBC,OAAOC,SAASC,MAAO,mBAAEV,MAAMF,KAAK,SAInCL,YACDA,4nBAGCC,MACDA,ylBA+CAiB,YA5CAC,KAAO,IAAInB,UAAU,CACrBoB,UAAW,iDACXC,KAAMhB,KACNiB,YAAa,CACTC,YAAatB,IAAIuB,WAAW,gBAAiB,wBAC7CC,eAAe,KAIvBN,KAAKO,OAELP,KAAKQ,iBAAiBR,KAAKS,OAAOC,QAAQ9B,MAAAA,IACtCK,EAAE0B,2BACEf,OAAOgB,UACPhB,OAAOgB,SAASC,YAGhBC,KAAOd,KAAKe,MAAMC,UACtBF,KAAKG,KAAK,iBAAiBC,YAAY,YAAYC,SAAS,YAC5DL,KAAKK,SAAS,iCACVC,cAAgBtC,IAAIuC,YAAY,CAChC,CAACC,IAAK,eAAgBC,UAAW,wBACjC,CAACD,IAAK,kBAAmBC,UAAW,0BAExCT,KAAKG,KAAK,0BAA0BO,IAAI,cAAe,SAClDC,yEAAkEL,QAAQ,0LAEiBA,QAAQ,0FAE3FM,EAAEC,IAAIC,8CAAqC1C,KAAKG,+DAIjEW,KAAKQ,iBAAiBR,KAAKS,OAAOoB,gBAAiB5C,IAC/CA,EAAE0B,2BACFzB,KAAK4C,OAAS7C,EAAE6C,OACI,WAAhB5C,KAAKM,4BACH,uBAAuBe,OACzBX,OAAOC,SAASkC,8CAEF,qBAAsB7C,6BAK1CH,UAAUiD,IAAI,QAAS,8BAA8BhD,GAAG,QAAS,8BAA8BJ,eAAeK,GAC5GA,EAAEQ,iBACFP,KAAK+C,OAAS,QACTlC,cACDA,ooBAEO,IAAIA,YAAYhB,SAASmD,cAAc,wBAC9C,kDACCC,KAAKjD"}