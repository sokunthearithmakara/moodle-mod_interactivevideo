{"version":3,"file":"manage.min.js","sources":["../src/manage.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * TODO describe module manage\n *\n * @module     mod_interactivevideo/manage\n * @copyright  2025 Sokunthearith Makara <sokunthearithmakara@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/templates'], function($, Templates) {\n    const bsAffix = $('body').hasClass('bs-5') ? '-bs' : '';\n    return {\n        settings: async function(courseid, coursecontextid, userid) {\n            let addToast = await import('core/toast');\n            let DynamicForm = await import('core_form/dynamicform');\n            let string = await import('core/str');\n            $(document).ready(function() {\n                const selector = document.querySelector(`#region-main-box #settings`);\n                const settingform = new DynamicForm(selector, 'mod_interactivevideo\\\\form\\\\settings_form');\n                settingform.addEventListener(settingform.events.FORM_SUBMITTED, (e) => {\n                    e.preventDefault();\n                    addToast.add(string.get_string('settingssaved', 'mod_interactivevideo'), {\n                        type: 'success',\n                    });\n                });\n                settingform.addEventListener(settingform.events.CANCEL_BUTTON_PRESSED, (e) => {\n                    e.preventDefault();\n                    settingform.load({\n                        courseid: courseid,\n                        contextid: coursecontextid,\n                        userid: userid,\n                        action: 'reset',\n                    });\n                    addToast.add(string.get_string('formvaluesarereset', 'mod_interactivevideo'), {\n                        type: 'info',\n                    });\n                });\n            });\n        },\n        list: async function(courseid, coursecontextid) {\n            let addToast = await import('core/toast');\n            let ModalForm, str;\n            let JSZip = await import('mod_interactivevideo/libraries/jszip');\n            window.JSZip = JSZip;\n            await import('mod_interactivevideo/libraries/jquery.dataTables');\n            await import('mod_interactivevideo/libraries/dataTables.bootstrap4');\n            await import('mod_interactivevideo/libraries/dataTables.buttons');\n            await import('mod_interactivevideo/libraries/buttons.html5');\n            await import('mod_interactivevideo/libraries/dataTables.select');\n            await import('mod_interactivevideo/libraries/select.bootstrap4');\n            await import('mod_interactivevideo/libraries/buttons.bootstrap4');\n            await import('mod_interactivevideo/libraries/buttons.colVis');\n            await import('mod_interactivevideo/libraries/dataTables.rowGroup');\n            await import('mod_interactivevideo/libraries/select2');\n            const addSelect2 = function() {\n                const tabledata = $('#videolist').DataTable();\n                let sectionname = [];\n                let videotype = [];\n                const sectionnameIndex = $(`#videolist thead th.sectionname`).index();\n                sectionname = tabledata.column(sectionnameIndex).data().unique().sort();\n                const videotypeIndex = $(`#videolist thead th.type`).index();\n                videotype = tabledata.column(videotypeIndex).data().unique().sort();\n                $(`<a class=\"btn iv-rounded-sm btn-secondary iv-font-weight-bold iv-ml-1\" href=\"javascript:void(0)\"\n                     id=\"filters\" title=\"${M.util.get_string('filters', \"mod_interactivevideo\")}\">\n                     <i class=\"fa fa-filter\"></i></a>`)\n                    .insertAfter(\"#videolist_filter\");\n                $(`.btn#filters`).on('click', function() {\n                    $('.search-container').slideToggle('fast', 'swing');\n                });\n                $(`<div class=\"bg-light iv-rounded hide mb-0 search-container w-100 p-3\" id=\"video-filters\">\n                    <div class=\"px-0 iv-form-group iv-form-group-sm font-size-sm form-row row pt-1 w-100 mb-0\">\n                    <div class=\"col-4 mb-1 title\">\n                        <label class=\"small text-muted d-block\">${M.util.get_string('title', \"mod_interactivevideo\")}</label>\n                        <input type=\"text\" class=\"form-control form-control-sm mb-1 w-100\" data-col=\"title\">\n                    </div>\n                    <div class=\"col-4 mb-1 sectionname\">\n                        <label class=\"small text-muted d-block\">${M.util.get_string('section', \"mod_interactivevideo\")}</label>\n                        <select class=\"custom-select custom-select-sm mb-1 w-100\" data-col=\"sectionname\" multiple>\n                        ${sectionname.map((section) => `<option value=\"${section}\">${section}</option>`).join('')}\n                        </select>\n                    </div>\n                    <div class=\"col-4 mb-1 type\">\n                        <label class=\"small text-muted d-block\">${M.util.get_string('type', \"mod_interactivevideo\")}</label>\n                        <select class=\"custom-select custom-select-sm mb-1 w-100\" data-col=\"type\" multiple>\n                        ${videotype.map((type) => `<option value=\"${type}\">${type}</option>`).join('')}\n                        </select>\n                        </div>\n                    </div>\n                </div>`).insertBefore('.row.top');\n\n                $('#video-filters .custom-select[multiple]').select2({\n                    dropdownParent: $('body') // Little hack to prevent page overflow when select2 is open\n                });\n                $('.custom-select').on('select2:open', function(e) { // Little hack to prevent page overflow when select2 is open\n                    const evt = \"scroll.select2\";\n                    $(e.target).parents().off(evt);\n                    $(window).off(evt);\n                });\n            };\n            let data = $('#listdata').text();\n            let columns = [\n                {\n                    data: 'id',\n                    className: 'w-0 exportable checkbox',\n                    render: function(data, type, row) {\n                        return `<input type=\"checkbox\" class=\"checked\" value=\"${row.id}\">`;\n                    },\n                    \"createdCell\": function(td, cellData) {\n                        $(td).data(\"id\", cellData);\n                    },\n                    \"title\": '<span class=\"sr-only\">ID</span><input type=\"checkbox\" id=\"select-all\"/>'\n                },\n                {\n                    data: null,\n                    className: 'w-0 actions nosort',\n                    render: function(data, type, row) {\n                        let retrn = `<div class=\"actions-wrapper d-flex flex-column\">`;\n                        if (row.edit) {\n                            retrn += `<a href=\"javascript:void(0)\" data-href=\"${M.cfg.wwwroot}/course/modedit.php?update=${row.id}\"\n                             class=\"p-1 iv_quickform\" data-contextid=\"${row.contextid}\" data-cmid=\"${row.id}\"\n                              data-interaction=\"${row.instance}\" data-courseid=\"${row.courseid}\"\n                              data${bsAffix}-toggle=\"tooltip\" data${bsAffix}-placement=\"right\" data${bsAffix}-html=\"true\"\n                              title=\"${M.util.get_string('edit', 'mod_interactivevideo')}\">\n                             <i class=\"fa fa-edit\" aria-hidden=\"true\"></i></a>`;\n                        }\n                        if (row.editinteraction) {\n                            retrn += `<a href=\"${M.cfg.wwwroot}/mod/interactivevideo/interactions.php?id=${row.id}\" target=\"_blank\"\n                            class=\"p-1\" data${bsAffix}-toggle=\"tooltip\" data${bsAffix}-placement=\"right\"\n                             title=\"${M.util.get_string('interactions', 'mod_interactivevideo')}\">\n                             <i class=\"fa fa-bullseye\" aria-hidden=\"true\"></i></a>`;\n                        }\n                        if (row.report) {\n                            retrn += `<a href=\"${M.cfg.wwwroot}/mod/interactivevideo/report.php?id=${row.id}\" target=\"_blank\"\n                             data-title=\"${row.title}\"\n                             data-href=\"${M.cfg.wwwroot}/mod/interactivevideo/report.php?id=${row.id}\"\n                              data${bsAffix}-toggle=\"tooltip\" data${bsAffix}-placement=\"right\" data${bsAffix}-html=\"true\"\n                             title=\"${M.util.get_string('report', 'mod_interactivevideo')}\"\n                             class=\"p-1 launch-report\"><i class=\"fa fa-table\" aria-hidden=\"true\"></i></a>`;\n                        }\n                        return retrn + `</div>`;\n                    }\n                },\n                {\n                    data: 'instance',\n                    className: 'd-none',\n                    render: function(data, type, row) {\n                        return `<a href=\"${row.editurl}\" title=\"${row.title}\">${row.id}</a>`;\n                    }\n                },\n                {\n                    data: null,\n                    className: 'poster exportable',\n                    render: function(data, type, row) {\n                        if (type === 'display') {\n                            return `<div class=\"wrapper d-flex flex-row align-items-start\">\n                                <div class=\"cursor-pointer poster-wrapper\"\n                         data-id=\"${row.id}\" data-instance=\"${row.instance}\">\n                                    <img src=\"${row.posterimage}\"\n                                        alt=\"${row.title}\"\n                                        class=\"poster-image ${row.squareposter}\"\n                                        loading=\"lazy\">\n                                    <div class=\"poster-overlay w-100 h-100 position-absolute\">\n                                        <i class=\"fa fa-play text-white fa-2x\"></i>\n                                        </div>\n                                </div>\n                                <a href=\"${M.cfg.wwwroot + '/mod/interactivevideo/view.php?id='\n                                + row.id}\" target=\"_blank\" class=\"title iv-font-weight-bold py-2 px-3\"\n                                      title=\"${row.title}\">${row.title}</a>\n                                </div>`;\n                        }\n                        return row.title;\n                    }\n                },\n                {\n                    data: 'title',\n                    className: 'd-none title exportable',\n                    render: function(data) {\n                        return data;\n                    }\n                },\n                {\n                    data: 'sectionnum',\n                    className: 'd-none w-0 exportable',\n                },\n                {\n                    data: 'type',\n                    className: 'w-0 type exportable',\n                },\n                {\n                    data: 'view',\n                    className: 'w-0 view exportable',\n                },\n                {\n                    data: 'duration',\n                    className: 'w-0 exportable',\n                    render: function(data, type) {\n                        if (type === 'display') {\n                            // Convert seconds to HH:MM:SS\n                            let seconds = Math.round(data);\n                            let hours = Math.floor(seconds / 3600);\n                            hours = (hours >= 10) ? hours : '0' + hours;\n                            let minutes = Math.floor((seconds - (hours * 3600)) / 60);\n                            minutes = (minutes >= 10) ? minutes : '0' + minutes;\n                            let remainingSeconds = seconds - (hours * 3600) - (minutes * 60);\n                            remainingSeconds = (remainingSeconds >= 10) ? remainingSeconds : '0' + remainingSeconds;\n                            return `${hours}:${minutes}:${remainingSeconds}`;\n                        }\n                        return data;\n                    }\n                },\n                {\n                    data: 'xp',\n                    className: 'w-0 exportable',\n                },\n                {\n                    data: 'count',\n                    className: 'w-0 exportable',\n                },\n            ];\n\n            // Get the enable activity types for activity columns.\n            let activitytypes = JSON.parse(data)[0].activitycount;\n            activitytypes = activitytypes.map(x => x.name);\n            activitytypes.sort(); // Sort to match the column order.\n\n            // Add activity type to columns.\n            activitytypes.forEach(x => {\n                columns.push({\n                    data: null,\n                    className: 'bg-light exportable ' + x,\n                    render: function(row) {\n                        return row.activitycount.find(a => a.name == x).count;\n                    },\n                    \"createdCell\": function(td) {\n                        const val = $(td).text();\n                        if (val > 0) {\n                            $(td).addClass('alert-success');\n                        }\n                    },\n                });\n            });\n\n            columns.push({\n                data: 'sectionname',\n                className: 'd-none sectionname w-0 exportable',\n            });\n            columns.push({\n                data: 'url',\n                className: 'exportable',\n                render: function(data) {\n                    return `<a href=\"${data}\" target=\"_blank\">${data}</a>`;\n                }\n            });\n\n            let datatable = $('#videolist').DataTable({\n                \"dom\": `<'d-flex w-100 justify-content-between`\n                    + `'<'d-flex align-items-start'Bl>'<'d-flex align-items-start'f>>`\n                    + `<'row mt-2 top'<'col-sm-6'i><'col-sm-6 d-flex justify-content-end'p>>`\n                    + `t`\n                    + `<'row mt-2'<'col-sm-6'i><'col-sm-6 d-flex justify-content-end'p>>`,\n                \"buttons\": [\n                    {\n                        extend: \"copyHtml5\",\n                        text: '<i class=\"bi bi-copy fa-fw fs-unset\"></i>',\n                        className: \"btn btn-sm border-0\",\n                        messageTop: null,\n                        title: null,\n                        exportOptions: {\n                            columns: ['.exportable'],\n                            format: {\n                                body: function(data) {\n                                    // Strip HTML tags to get text only\n                                    const div = document.createElement(\"div\");\n                                    div.innerHTML = data;\n                                    return (div.textContent || div.innerText || \"\").trim();\n                                }\n                            }\n                        }\n                    },\n                    {\n                        extend: \"csvHtml5\",\n                        text: '<i class=\"bi bi-filetype-csv fa-fw fs-unset\"></i>',\n                        className: \"btn btn-sm border-0\",\n                        exportOptions: {\n                            columns: ['.exportable'],\n                            format: {\n                                body: function(data) {\n                                    // Strip HTML tags to get text only\n                                    const div = document.createElement(\"div\");\n                                    div.innerHTML = data;\n                                    return (div.textContent || div.innerText || \"\").trim();\n                                }\n                            }\n                        }\n                    },\n                    {\n                        extend: \"excelHtml5\",\n                        text: '<i class=\"bi bi-file-earmark-excel fa-fw fs-unset\"></i>',\n                        className: \"btn btn-sm border-0\",\n                        exportOptions: {\n                            columns: ['.exportable'],\n                            format: {\n                                body: function(data) {\n                                    // Strip HTML tags to get text only\n                                    const div = document.createElement(\"div\");\n                                    div.innerHTML = data;\n                                    return (div.textContent || div.innerText || \"\").trim();\n                                }\n                            }\n                        }\n                    }\n                ],\n                \"initComplete\": function() {\n                    $(`[data${bsAffix}-toggle=\"tooltip\"]`).tooltip();\n                    $(\"table#videolist\").wrap(\"<div style='overflow:auto;position:relative' class='tablewrapper'></div>\");\n                    $(\"#list .dataTables_length\").addClass(\"d-inline iv-ml-1\");\n                    $(\"#list .dataTables_filter\").addClass(\"d-inline iv-float-right\");\n                    $(\"#list .table-responsive\").addClass(\"p-1\");\n                    $(\"#list .spinner-grow\").remove();\n                    $(\"table#videolist\").removeClass(\"d-none\");\n                    $(\"#background-loading\").fadeOut(300);\n\n                    // Add select2 to the search input\n                    addSelect2();\n                },\n                \"deferRender\": true,\n                \"rowId\": \"id\",\n                \"pageLength\": 10,\n                \"order\": [[5, \"asc\"]],\n                \"pagingType\": \"full\",\n                \"language\": {\n                    \"lengthMenu\": \"_MENU_\",\n                    \"zeroRecords\": M.util.get_string('nofound', \"mod_interactivevideo\"),\n                    \"search\": `<span class=\"d-none d-md-inline\">${M.util.get_string('search', \"mod_interactivevideo\")}</span>`,\n                    \"info\": M.util.get_string('datatableinfo', \"mod_interactivevideo\"),\n                    \"infoEmpty\": M.util.get_string('datatableinfoempty', \"mod_interactivevideo\"),\n                    \"infoFiltered\": M.util.get_string('datatableinfofiltered', \"mod_interactivevideo\"),\n                    \"paginate\": {\n                        \"first\": '<i class=\"bi bi-chevron-double-left fs-unset\"></i>',\n                        \"last\": '<i class=\"bi bi-chevron-double-right fs-unset\"></i>',\n                        \"next\": '<i class=\"bi bi-chevron-right fs-unset\"></i>',\n                        \"previous\": '<i class=\"bi bi-chevron-left fs-unset\"></i>'\n                    },\n                    \"select\": {\n                        rows: {\n                            _: M.util.get_string('rowsselected', 'mod_interactivevideo'),\n                        }\n                    }\n                },\n                select: {\n                    style: 'multi',\n                    selector: 'td:first-child input[type=\"checkbox\"]',\n                },\n                data: JSON.parse(data),\n                rowGroup: {\n                    dataSrc: 'sectionname',\n                },\n                columnDefs: [\n                    {\n                        \"orderable\": false,\n                        \"targets\": [0, 1],\n                    },\n                ],\n                orderFixed: [5, \"asc\"],\n                columns: columns,\n            });\n\n            $('#video-filters input, #video-filters select').on('keyup change', function() {\n                let col = $(this).data('col');\n                let val = $(this).val();\n                let isArray = Array.isArray(val);\n                if (val.length > 0) {\n                    if (isArray) {\n                        val = val.join('|');\n                    }\n                    datatable.column(`.${col}`).search(val, true, false);\n                } else {\n                    datatable.column(`.${col}`).search('', true, false);\n                }\n                datatable.draw();\n            });\n\n            datatable.on(\"draw\", function() {\n                $('tr.selected td.checkbox input').prop(\"checked\", true);\n                $('tr:not(.selected) td.checkbox input').prop(\"checked\", false);\n            });\n\n            datatable.on(\"search\", function() {\n                // Reset the select all checkbox\n                $(\"#select-all\").prop(\"checked\", false);\n                // De-select all rows\n                datatable.rows().deselect();\n            });\n\n            $(document).on(\"click\", \"#select-all\", function() {\n                if ($(this).prop(\"checked\")) {\n                    datatable.rows({\n                        search: \"applied\",\n                    }).select();\n                    $('td.checkbox input').prop(\"checked\", true);\n                } else {\n                    datatable.rows({\n                        search: \"applied\",\n                    }).deselect();\n                    $('td.checkbox input').prop(\"checked\", false);\n                }\n            });\n\n            datatable.on(\"select deselect\", function(e) {\n                e.stopImmediatePropagation();\n                // Change the checkbox state\n                var selectedRows = datatable.rows({selected: true});\n                // For each selected row, find the checkbox with class \"checked\" in the first column and check it\n                selectedRows.every(function() {\n                    var row = this.node();\n                    $(row).find(\"td:first-child input\").prop(\"checked\", true);\n                    return true;\n                });\n\n                var deselectedRows = datatable.rows({selected: false});\n                // For each deselected row, find the checkbox with class \"checked\" in the first column and uncheck it\n                deselectedRows.every(function() {\n                    var row = this.node();\n                    $(row).find(\"td:first-child input\").prop(\"checked\", false);\n                    return true;\n                });\n\n                if (deselectedRows.count() === 0) {\n                    $(\"#select-all\").prop(\"checked\", true);\n                }\n\n                if (selectedRows.count() === 0 || selectedRows.count() < datatable.rows({search: \"applied\"}).count()) {\n                    $(\"#select-all\").prop(\"checked\", false);\n                }\n\n                if (selectedRows.count() > 0) {\n                    // Insert the bulk actions\n                    $('#bulkactions').remove();\n                    $('#videolist_length').after(`<div class=\"d-flex align-items-center\" id=\"bulkactions\"><button type=\"button\"\n                        class=\"btn btn-sm btn-secondary iv-ml-1\" id=\"bulkreset\">\n                        ${M.util.get_string('resetsettings', 'mod_interactivevideo')}</button>\n                        <button type=\"button\"\n                        class=\"btn btn-sm btn-secondary iv-ml-1\" id=\"bulkappearance\">\n                        ${M.util.get_string('appearancesettings', 'mod_interactivevideo')}</button>\n                        <button type=\"button\"\n                        class=\"btn btn-sm btn-secondary iv-ml-1\" id=\"bulkbehavior\">\n                        ${M.util.get_string('behaviorsettings', 'mod_interactivevideo')}</button>\n                        </div>`);\n                } else {\n                    $('#bulkactions').remove();\n                }\n            });\n\n            $(document).on(\"click\", \"#bulkreset, #bulkappearance, #bulkbehavior\", async function() {\n                let $this = $(this);\n                if (!ModalForm) {\n                    ModalForm = await import('core_form/modalform');\n                }\n                if (!str) {\n                    str = await import('core/str');\n                }\n                let selectedRows = datatable.rows({selected: true});\n                let ids = [];\n                selectedRows.every(function() {\n                    ids.push(this.data().id);\n                    return true;\n                });\n                let bulkdata = {\n                    courseid: courseid,\n                    cmids: ids.join(','), // Convert the array to a string\n                    contextid: coursecontextid,\n                };\n\n                bulkdata.action = $this.attr('id').replaceAll('bulk', '');\n\n                let form = new ModalForm({\n                    formClass: 'mod_interactivevideo\\\\form\\\\reset_form',\n                    args: bulkdata,\n                    modalConfig: {\n                        title: M.util.get_string('reset', 'mod_interactivevideo'),\n                        removeOnClose: true,\n                    }\n                });\n\n                form.show();\n\n                form.addEventListener(form.events.FORM_SUBMITTED, (e) => {\n                    e.stopImmediatePropagation();\n                    addToast.add(str.get_string('settingssaved', 'mod_interactivevideo'), {\n                        type: 'success',\n                    });\n                    let results = e.detail;\n                    if (bulkdata.action === 'reset' || bulkdata.action === 'appearance') {\n                        let page = datatable.page();\n                        results.forEach(result => {\n                            if (result.displayoptions) {\n                                let displayoptions = JSON.parse(result.displayoptions);\n                                let newdata = datatable.row(`#${result.id}`).data();\n                                newdata.squareposter = displayoptions.squareposterimage == 1 ? 'square' : '';\n                                newdata.posterimage = result.posterimage;\n                                datatable.row(`#${result.id}`).data(newdata).draw();\n                            }\n                        });\n                        datatable.page(page).draw(false);\n                    }\n                });\n            });\n\n            $(document).on(\"click\", \".checked\", function() {\n                if ($(this).prop(\"checked\")) {\n                    datatable.row($(this).closest(\"tr\")).select();\n                } else {\n                    datatable.row($(this).closest(\"tr\")).deselect();\n                }\n            });\n\n            // Launch report modal when clicking on the report icon.\n            let ModalFactory;\n            $(document).on('click', '.launch-report', async function(e) {\n                e.preventDefault();\n                const href = $(this).data('href');\n                let $this = $(this);\n                if (!ModalFactory) {\n                    try {\n                        ModalFactory = await import('core/modal_factory');\n                    } catch (error) {\n                        ModalFactory = await import('core/modal');\n                    }\n                }\n                let ModalEvents = await import('core/modal_events');\n                let str = await import('core/str');\n                const reportModal = await ModalFactory.create({\n                    body: await Templates.render('mod_interactivevideo/backgroundloading', {show: true}) +\n                        `<iframe src=\"${href}&embed=1\"\n                         class=\"w-100 position-absolute h-100 border-0\"\n                         allow=\"autoplay\" style=\"z-index:1050\"></iframe>`,\n                    title: await str.get_string('reportfor', 'mod_interactivevideo', $this.data('title')),\n                    large: true,\n                    show: false,\n                    removeOnClose: true,\n                    isVerticallyCentered: true,\n                });\n\n                const root = reportModal.getRoot();\n                root.attr('id', 'reportModal').addClass('modal-fullscreen iv-modal');\n                root.find('.modal-body').addClass('p-0');\n                reportModal.show();\n                root.off(ModalEvents.hidden);\n                root.on(ModalEvents.hidden, function() {\n                    reportModal.destroy();\n                });\n            });\n\n            // Launch video when clicking on the poster.\n            $(document).on('click', '.poster-wrapper', async function(e) {\n                e.preventDefault();\n                if (!ModalFactory) {\n                    try {\n                        ModalFactory = await import('core/modal_factory');\n                    } catch (error) {\n                        ModalFactory = await import('core/modal');\n                    }\n                }\n                let ModalEvents = await import('core/modal_events');\n                const reportModal = await ModalFactory.create({\n                    body: await Templates.render('mod_interactivevideo/backgroundloading', {show: true}) +\n                        `<iframe src=\"${M.cfg.wwwroot}/mod/interactivevideo/view.php?id=${$(this)\n                            .data('id')}&embed=1&dm=1&df=1&preview=1\"\n                         class=\"w-100 position-absolute h-100 border-0\"\n                         allow=\"autoplay\" style=\"z-index:1050\"></iframe>`,\n                    large: true,\n                    show: false,\n                    removeOnClose: true,\n                    isVerticallyCentered: true,\n                });\n                const root = reportModal.getRoot();\n                root.attr('id', 'posterModal');\n                root.find('.modal-header').remove();\n                root.find('.modal-content').addClass('bg-black border-0');\n                reportModal.show();\n                root.off(ModalEvents.hidden);\n                root.on(ModalEvents.hidden, function() {\n                    reportModal.destroy();\n                });\n            });\n\n            // Quick form for interactive video settings.\n            $(document).on('click', '.iv_quickform', async function(e) {\n                const $this = $(this);\n                e.preventDefault();\n                let formdata = {\n                    contextid: $(this).data('contextid'),\n                    cmid: $(this).data('cmid'),\n                    courseid: $(this).data('courseid'),\n                    interaction: $(this).data('interaction'),\n                };\n\n                if (!ModalForm) {\n                    ModalForm = await import('core_form/modalform');\n                }\n\n                if (!str) {\n                    str = await import('core/str');\n                }\n\n                let form = new ModalForm({\n                    formClass: 'mod_interactivevideo\\\\form\\\\quicksettings_form',\n                    args: formdata,\n                    modalConfig: {\n                        title: await str.get_string('quicksettings', 'mod_interactivevideo'),\n                        removeOnClose: true,\n                    }\n                });\n\n                form.show();\n\n                form.addEventListener(form.events.LOADED, (e) => {\n                    e.stopImmediatePropagation();\n                    // Replace the .modal-lg class with .modal-xl.\n                    setTimeout(() => {\n                        $('.modal.show').addClass('path-mod-interactivevideo');\n                        $('.modal-dialog').removeClass('modal-lg').addClass('modal-xl');\n                    }, 1000);\n                    setTimeout(async() => {\n                        let strings = await str.get_strings([\n                            {key: 'moresettings', component: 'mod_interactivevideo'},\n                            {key: 'resettodefaults', component: 'mod_interactivevideo'},\n                        ]);\n                        $('[data-region=\"footer\"]').css('align-items', 'unset')\n                            .prepend(`<span class=\"btn btn-secondary iv-mr-1 default\" title=\"${strings[1]}\">\n                                <i class=\"fa fa-refresh\"></i></span>\n                                <a type=\"button\" class=\"btn btn-secondary iv-mr-auto\" target=\"_blank\" data-dismiss=\"modal\"\n                                 title=\"${strings[0]}\"  data-bs-dismiss=\"modal\"\n                                 href=\"${M.cfg.wwwroot}/course/modedit.php?update=${formdata.cmid}\"><i class=\"fa fa-cog\"></i>\n                                 </a>`);\n                    }, 2000);\n                });\n\n                form.addEventListener(form.events.FORM_SUBMITTED, (e) => {\n                    e.stopImmediatePropagation();\n                    addToast.add(str.get_string('settingssaved', 'mod_interactivevideo'), {\n                        type: 'success',\n                    });\n                    // Replace the row with the new data.\n                    let row = datatable.row($this.closest('tr'));\n                    let newdata = row.data();\n                    let displayoptions = e.detail.displayoptions;\n                    displayoptions = JSON.parse(displayoptions);\n                    newdata.title = e.detail.name;\n                    newdata.squareposter = displayoptions.squareposterimage == 1 ? 'square' : '';\n                    newdata.posterimage = e.detail.posterimage;\n                    let page = datatable.page();\n                    datatable.row($this.closest('tr')).data(newdata).draw();\n                    datatable.page(page).draw(false);\n                });\n\n                let DynamicForm;\n                $(document).off('click', '.default').on('click', '.default', async function(e) {\n                    e.preventDefault();\n                    formdata.action = 'reset';\n                    if (!DynamicForm) {\n                        DynamicForm = await import('core_form/dynamicform');\n                    }\n                    let form = new DynamicForm(document.querySelector('[data-region=\"body\"]'),\n                        'mod_interactivevideo\\\\form\\\\quicksettings_form');\n                    form.load(formdata);\n                    addToast.add(str.get_string('formvaluesarereset', 'mod_interactivevideo'), {\n                        type: 'info',\n                    });\n                });\n            });\n        }\n    };\n});"],"names":["define","$","Templates","bsAffix","hasClass","settings","async","courseid","coursecontextid","userid","addToast","DynamicForm","string","document","ready","selector","querySelector","settingform","addEventListener","events","FORM_SUBMITTED","e","preventDefault","add","get_string","type","CANCEL_BUTTON_PRESSED","load","contextid","action","list","ModalForm","str","JSZip","window","data","text","columns","className","render","row","id","td","cellData","retrn","edit","M","cfg","wwwroot","instance","util","editinteraction","report","title","editurl","posterimage","squareposter","seconds","Math","round","hours","floor","minutes","remainingSeconds","activitytypes","JSON","parse","activitycount","map","x","name","sort","forEach","push","find","a","count","addClass","ModalFactory","datatable","DataTable","extend","messageTop","exportOptions","format","body","div","createElement","innerHTML","textContent","innerText","trim","tooltip","wrap","remove","removeClass","fadeOut","tabledata","sectionname","videotype","sectionnameIndex","index","column","unique","videotypeIndex","insertAfter","on","slideToggle","section","join","insertBefore","select2","dropdownParent","evt","target","parents","off","addSelect2","rows","_","select","style","rowGroup","dataSrc","columnDefs","orderFixed","col","this","val","isArray","Array","length","search","draw","prop","deselect","stopImmediatePropagation","selectedRows","selected","every","node","deselectedRows","after","$this","ids","bulkdata","cmids","attr","replaceAll","form","formClass","args","modalConfig","removeOnClose","show","results","detail","page","result","displayoptions","newdata","squareposterimage","closest","href","error","ModalEvents","reportModal","create","large","isVerticallyCentered","root","getRoot","hidden","destroy","formdata","cmid","interaction","LOADED","setTimeout","strings","get_strings","key","component","css","prepend"],"mappings":"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"}